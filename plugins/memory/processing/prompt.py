conversation_prompt = """
分析群聊消息并提取以下结构化信息。需要区分已完结和未完结的话题：

1. 已完结话题：时间较早、讨论告一段落的话题。对这类话题，提取详细信息。
2. 未完结话题：最近正在讨论、尚未结束的话题。对这类话题，返回相关消息编号并评估话题延续可能性。

消息格式：[编号] [时间] {用户}：内容

返回结果格式：
{
    "completed_topics": [
    {
        "topic": "已完结话题名称",
        "entities": ["实体1", "对象2", "概念3"],
        "summary": "{用户A}讨论了X，{用户B}回应了Y",
        "start_time": "YYYY-MM-DD HH:mm",
        "end_time": "YYYY-MM-DD HH:mm",
        "message_ids": [1, 2, 3, 4] // 相关消息的编号
    }
    ],
    "ongoing_topics": [
    {
        "topic": "未完结话题名称",
        "entities": ["相关实体1", "相关实体2"], // 捕获未完结话题的相关实体
        "message_ids": [8, 9, 10], // 相关消息的编号
        "continuation_probability": 0.7 // 话题延续的可能性 (0.0-1.0)
    }
    ]
}

判断已完结话题标准：
1. 最后一条相关消息已经过去较长时间（与最新消息相比）
2. 话题已有明确结论或自然终止

未完结话题的continuation_probability评估标准：
1. 高概率 (0.7-1.0): 话题急需人解答/参与；存在直接提问
2. 中等概率 (0.3-0.7): 话题可能受益于人参与；存在间接提问；讨论陷入停滞
3. 低概率 (0.0-0.3): 人类交流顺畅；无需干预；话题即将自然结束

注意：
- 每条消息可能属于多个话题
- 未完结话题无需提供详细总结，但需要捕获相关实体和评估话题延续可能性
- 确保每个话题至少有一个实体

群聊消息:
CONVERSATION_PLACEHOLDER
"""