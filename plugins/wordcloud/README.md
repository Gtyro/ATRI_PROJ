# è¯äº‘æ’ä»¶

## ç®€ä»‹

è¯äº‘æ’ä»¶æ˜¯ä¸€ä¸ªç”¨äºŽç»Ÿè®¡å’Œå¯è§†åŒ–èŠå¤©å†…å®¹è¯é¢‘çš„å·¥å…·ã€‚å®ƒä¼šåˆ†æžèŠå¤©è®°å½•ï¼Œæå–å…³é”®è¯å¹¶ç”Ÿæˆè¯äº‘æ•°æ®ï¼Œå¯åœ¨å‰ç«¯ç›´è§‚åœ°å±•ç¤ºèŠå¤©ä¸­çš„çƒ­é—¨è¯é¢˜ã€‚

## ç‰¹æ€§

- ðŸ•’ **å®šæ—¶ç»Ÿè®¡**ï¼šæ¯å°æ—¶è‡ªåŠ¨ç»Ÿè®¡èŠå¤©å†…å®¹è¯é¢‘
- ðŸ” **æ™ºèƒ½åˆ†è¯**ï¼šä½¿ç”¨jiebaåˆ†è¯ï¼Œæ”¯æŒä¸­æ–‡åˆ†è¯å’Œæ–°è¯å‘çŽ°
- ðŸ§¹ **é«˜çº§è¿‡æ»¤**ï¼šè¿‡æ»¤åœç”¨è¯ã€æ•æ„Ÿè¯ã€é“¾æŽ¥å’Œå•å­—è¯
- ðŸ“Š **æ•°æ®å¯è§†åŒ–**ï¼šæ”¯æŒåœ¨WebUIä¸­å±•ç¤ºè¯äº‘
- ðŸ“‹ **åŽ†å²æŸ¥è¯¢**ï¼šå¯æŸ¥çœ‹åŽ†å²è¯äº‘æ•°æ®
- ðŸ› ï¸ **å¯é…ç½®**ï¼šæ”¯æŒè‡ªå®šä¹‰è¯äº‘å‚æ•°

## ä½¿ç”¨æ–¹æ³•

### å‰ç«¯ä½¿ç”¨

1. åœ¨ç®¡ç†é¢æ¿ä¸­ç‚¹å‡»"èŠå¤©è¯äº‘"èœå•é¡¹
2. æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„è¯äº‘
3. å¯ä»¥è°ƒæ•´è¯æ•°ã€åˆ·æ–°æ•°æ®æˆ–æŸ¥çœ‹åŽ†å²æ•°æ®

### å‘½ä»¤è¡Œä½¿ç”¨

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹è¯äº‘æ•°æ®ï¼š

```
/wordcloud [è¯æ•°]
```

ç¤ºä¾‹ï¼š`/wordcloud 20` æ˜¾ç¤ºé¢‘çŽ‡æœ€é«˜çš„20ä¸ªè¯

## æ•°æ®å­˜å‚¨

- è¯äº‘æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“çš„ `wordcloud_data` è¡¨ä¸­
- åŒæ—¶ä¼šä¿å­˜ä¸ºJSONæ–‡ä»¶åœ¨ `data/wordcloud/` ç›®å½•ä¸‹
- æ–‡ä»¶å‘½åæ ¼å¼ä¸º `{æœˆ-æ—¥}-{å°æ—¶}.json`

## é…ç½®é¡¹

```python
# é»˜è®¤èŽ·å–è¿‡åŽ»24å°æ—¶çš„æ¶ˆæ¯
wordcloud_hours: int = 24
# æœ€å°‘æ˜¾ç¤ºçš„è¯æ•°
wordcloud_min_words: int = 30
# æœ€å¤šæ˜¾ç¤ºçš„è¯æ•°
wordcloud_max_words: int = 100
# æ˜¯å¦è¿‡æ»¤æ•æ„Ÿè¯
wordcloud_filter_sensitive: bool = True
# æ•æ„Ÿè¯åˆ—è¡¨æ–‡ä»¶è·¯å¾„
wordcloud_sensitive_words_file: str = "data/wordcloud/sensitive_words.txt"
# åœç”¨è¯åˆ—è¡¨æ–‡ä»¶è·¯å¾„
wordcloud_stopwords_file: str = "data/wordcloud/stopwords.txt"
# æ˜¯å¦å¼€å¯æ–°è¯å‘çŽ°
wordcloud_new_words_discovery: bool = True
# æœ€å°è¯é•¿åº¦
wordcloud_min_word_length: int = 2
```

## è‡ªå®šä¹‰è¯è¡¨

### åœç”¨è¯

åœç”¨è¯æ˜¯é‚£äº›å¯¹è¯äº‘æ²¡æœ‰å®žè´¨æ„ä¹‰çš„è¯ï¼Œå¦‚"çš„"ã€"äº†"ã€"æ˜¯"ç­‰ã€‚

ç¼–è¾‘æ–‡ä»¶ï¼š`data/wordcloud/stopwords.txt`
æ¯è¡Œä¸€ä¸ªè¯ï¼Œä¾‹å¦‚ï¼š
```
çš„
äº†
æ˜¯
```

### æ•æ„Ÿè¯

æ•æ„Ÿè¯æ˜¯é‚£äº›ä¸å¸Œæœ›åœ¨è¯äº‘ä¸­æ˜¾ç¤ºçš„è¯ã€‚

ç¼–è¾‘æ–‡ä»¶ï¼š`data/wordcloud/sensitive_words.txt`
æ¯è¡Œä¸€ä¸ªè¯ã€‚

### ç”¨æˆ·è¯å…¸

ç”¨æˆ·è¯å…¸ç”¨äºŽå‘Šè¯‰åˆ†è¯å™¨ä¸€äº›ä¸“æœ‰åè¯æˆ–æ–°è¯ï¼Œä»¥æ”¹å–„åˆ†è¯æ•ˆæžœã€‚

ç¼–è¾‘æ–‡ä»¶ï¼š`data/wordcloud/user_dict.txt`
æ ¼å¼ä¸ºï¼š`è¯è¯­ è¯é¢‘`ï¼Œä¾‹å¦‚ï¼š
```
äººå·¥æ™ºèƒ½ 10
æœºå™¨å­¦ä¹  10
```

## APIæŽ¥å£

### èŽ·å–è¯äº‘æ•°æ®

```
GET /api/wordcloud/data?limit={limit}&refresh={refresh}
```

### èŽ·å–åŽ†å²è¯äº‘æ•°æ®

```
GET /api/wordcloud/history?date={date}&hour={hour}
```

### æ‰‹åŠ¨ç”Ÿæˆè¯äº‘æ•°æ®

```
POST /api/wordcloud/generate?word_limit={word_limit}&hours={hours}
```

## å¼€å‘è€…ä¿¡æ¯

- æ’ä»¶ä¾èµ–äºŽ jieba åˆ†è¯åº“å’Œ echarts-wordcloud å‰ç«¯ç»„ä»¶
- æ’ä»¶ä½¿ç”¨äº†ç»Ÿä¸€çš„æ•°æ®åº“ç®¡ç†æœºåˆ¶ï¼ˆdb_managerï¼‰
- è‡ªåŠ¨ä½¿ç”¨å®šæ—¶ä»»åŠ¡æœºåˆ¶ï¼ˆnonebot_plugin_apschedulerï¼‰

## ä¾èµ–é¡¹

- jieba>=0.42.1
- nonebot2>=2.0.0
- nonebot-plugin-apscheduler>=0.3.0
- tortoise-orm>=0.19.0
- echarts>=5.4.3
- echarts-wordcloud>=2.1.0 